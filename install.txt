pip uninstall -y torch torchvision torchaudio && pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
conda activate marl && pip install torch==2.1.2 torchvision==0.16.2 torchaudio==2.1.2 --index-url https://download.pytorch.org/whl/cu118
ls -l /usr/local/ | grep cuda

export PATH=/ssd/apps/cuda/11.8/bin${PATH:+:${PATH}}
source ~/.bashrc

unset http_proxy https_proxy

pip install flash-attn==2.7.3 --no-build-isolation

运行顺序：
source setup_nccl.sh
export PATH=/ssd/apps/cuda/11.8/bin${PATH:+:${PATH}} && export LD_LIBRARY_PATH=/ssd/apps/cuda/11.8/lib64${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}
nvcc --version
ray stop
rm -rf /tmp/ray && ray start --head --port=6378 --num-gpus=8
ray status
python main_bai.py --config projects/internlm2/1B/1B_ppo_ds_vllm_8gpu.py --work_dir ../work_dirs2/internlm2_1b_ppo_8gpu  > training_output2.log 2>&1

NCCL环境变量
source setup_nccl.sh
export NCCL_P2P_DISABLE=1 && export NCCL_SHM_DISABLE=0 && export NCCL_SOCKET_IFNAME=eth0 && export NCCL_DEBUG=INFO && export CUDA_DEVICE_ORDER=PCI_BUS_ID
export NCCL_P2P_DISABLE=1 # 禁用P2P，强制使用SHM
export NCCL_SHM_DISABLE=0 # 启用SHM
export NCCL_SOCKET_IFNAME=eth0 # 指定网络接口
export NCCL_DEBUG=INFO # 设置调试信息级别
export CUDA_DEVICE_ORDER=PCI_BUS_ID # 确保 CUDA 设备顺序一致

cursor:
irm https://raw.githubusercontent.com/yeongpin/cursor-free-vip/main/scripts/install.ps1 | iex

Package            Version
------------------ ------------
certifi            2022.12.7
charset-normalizer 2.1.1
cmake              3.25.0
einops             0.8.1
filelock           3.13.1
flash_attn         2.7.3
idna               3.4
Jinja2             3.1.4
lit                15.0.7
MarkupSafe         2.1.5
mpmath             1.3.0
networkx           3.3
numpy              1.24.0
pillow             11.0.0
pip                25.0
psutil             7.0.0
requests           2.28.1
setuptools         75.8.0
sympy              1.13.1
torch              2.0.1+cu118
torchaudio         2.0.2+cu118
torchvision        0.15.2+cu118
triton             2.0.0
typing_extensions  4.12.2
urllib3            1.26.13
wheel              0.45.1

Package                       Version
----------------------------- --------------
accelerate                    1.4.0
addict                        2.4.0
aiohappyeyeballs              2.4.6
aiohttp                       3.11.13
aiohttp-cors                  0.7.0
aioprometheus                 23.12.0
aiosignal                     1.3.2
airportsdata                  20250224
altair                        5.5.0
annotated-types               0.7.0
anyio                         4.8.0
appdirs                       1.4.4
argon2-cffi                   23.1.0
argon2-cffi-bindings          21.2.0
arrow                         1.3.0
arxiv                         2.1.3
asttokens                     3.0.0
async-lru                     2.0.4
async-timeout                 5.0.1
attrs                         25.1.0
babel                         2.17.0
beautifulsoup4                4.13.3
bitsandbytes                  0.45.3
bleach                        6.2.0
blessed                       1.20.0
blinker                       1.9.0
Brotli                        1.1.0
cachetools                    5.5.2
certifi                       2022.12.7
cffi                          1.17.1
cfgv                          3.4.0
charset-normalizer            2.1.1
click                         8.1.8
cloudpickle                   3.1.1
cmake                         3.25.0
colorama                      0.4.6
colorful                      0.5.6
comm                          0.2.2
contourpy                     1.3.1
cupy-cuda12x                  12.1.0
cycler                        0.12.1
datasets                      3.3.2
debugpy                       1.8.12
decorator                     5.2.1
deepspeed                     0.16.4
defusedxml                    0.7.1
dill                          0.3.8
diskcache                     5.6.3
distlib                       0.3.9
distro                        1.9.0
docker-pycreds                0.4.0
duckduckgo_search             5.3.1b1
einops                        0.8.1
et_xmlfile                    2.0.0
exceptiongroup                1.2.2
executing                     2.2.0
fastapi                       0.115.10
fastjsonschema                2.21.1
fastrlock                     0.8.3
feedparser                    6.0.11
filelock                      3.13.1
flash_attn                    2.7.3
fonttools                     4.56.0
fqdn                          1.5.1
frozenlist                    1.5.0
fsspec                        2024.12.0
func_timeout                  4.3.5
genson                        1.3.0
gitdb                         4.0.12
GitPython                     3.1.44
google-api-core               2.24.1
google-auth                   2.38.0
googleapis-common-protos      1.68.0
gpustat                       1.1.1
griffe                        0.49.0
grpcio                        1.59.3
h11                           0.14.0
h2                            4.2.0
hjson                         3.1.0
hpack                         4.1.0
httpcore                      1.0.7
httptools                     0.6.4
httpx                         0.28.1
huggingface-hub               0.29.1
hyperframe                    6.1.0
identify                      2.6.8
idna                          3.4
imageio                       2.37.0
interegular                   0.3.3
ipykernel                     6.29.5
ipython                       8.33.0
ipywidgets                    8.1.5
iso3166                       2.1.1
isoduration                   20.11.0
jedi                          0.19.2
Jinja2                        3.1.4
json5                         0.10.0
jsonpointer                   3.0.0
jsonschema                    4.23.0
jsonschema-specifications     2024.10.1
jupyter                       1.1.1
jupyter_client                8.6.3
jupyter-console               6.6.3
jupyter_core                  5.7.2
jupyter-events                0.12.0
jupyter-lsp                   2.2.5
jupyter_server                2.15.0
jupyter_server_terminals      0.5.3
jupyterlab                    4.3.5
jupyterlab_pygments           0.3.0
jupyterlab_server             2.27.3
jupyterlab_widgets            3.0.13
kiwisolver                    1.4.8
lagent                        0.2.4
lark                          1.2.2
lazy_loader                   0.4
lit                           15.0.7
loguru                        0.7.3
markdown-it-py                3.0.0
MarkupSafe                    2.1.5
matplotlib                    3.10.1
matplotlib-inline             0.1.7
mdurl                         0.1.2
mistune                       3.1.2
mmengine                      0.10.6
mpmath                        1.3.0
msgpack                       1.1.0
multidict                     6.1.0
multiprocess                  0.70.16
narwhals                      1.28.0
nbclient                      0.10.2
nbconvert                     7.16.6
nbformat                      5.10.4
nest-asyncio                  1.6.0
networkx                      3.3
ninja                         1.11.1.3
nodeenv                       1.9.1
notebook                      7.3.2
notebook_shim                 0.2.4
numpy                         1.24.0
nvidia-ml-py                  12.570.86
opencensus                    0.11.4
opencensus-context            0.1.3
opencv-python                 4.11.0.86
openpyxl                      3.1.5
orjson                        3.10.15
outlines                      0.2.1
outlines_core                 0.1.26
overrides                     7.7.0
packaging                     24.2
pandas                        2.2.3
pandocfilters                 1.5.1
parso                         0.8.4
peft                          0.14.0
pexpect                       4.9.0
phx-class-registry            4.1.0
pillow                        11.0.0
pip                           25.0
platformdirs                  4.3.6
pre_commit                    4.1.0
prometheus_client             0.21.1
prompt_toolkit                3.0.50
propcache                     0.3.0
proto-plus                    1.26.0
protobuf                      4.25.6
psutil                        7.0.0
ptyprocess                    0.7.0
pure_eval                     0.2.3
py-cpuinfo                    9.0.0
py-spy                        0.4.0
pyarrow                       19.0.1
pyasn1                        0.6.1
pyasn1_modules                0.4.1
pycparser                     2.22
pydantic                      2.10.6
pydantic_core                 2.27.2
pydeck                        0.9.1
Pygments                      2.19.1
pynvml                        11.5.0
pyparsing                     3.2.1
python-dateutil               2.9.0.post0
python-dotenv                 1.0.1
python-json-logger            3.2.1
pytz                          2025.1
PyYAML                        6.0.2
pyzmq                         26.2.1
quantile-python               1.1
ray                           2.9.1
referencing                   0.36.2
regex                         2024.11.6
requests                      2.32.3
rfc3339-validator             0.1.4
rfc3986-validator             0.1.1
rich                          13.9.4
rpds-py                       0.23.1
rsa                           4.9
safetensors                   0.5.3
scikit-image                  0.25.2
scipy                         1.15.2
Send2Trash                    1.8.3
sentencepiece                 0.2.0
sentry-sdk                    2.22.0
setproctitle                  1.3.5
setuptools                    75.8.0
sgmllib3k                     1.0.0
six                           1.17.0
smart-open                    7.1.0
smmap                         5.0.2
sniffio                       1.3.1
socksio                       1.0.0
soupsieve                     2.6
stack-data                    0.6.3
starlette                     0.46.0
streamlit                     1.42.2
sympy                         1.13.1
tenacity                      9.0.0
tensorboardX                  2.6.2.2
termcolor                     2.5.0
terminado                     0.18.1
tifffile                      2025.2.18
tiktoken                      0.9.0
timeout-decorator             0.5.0
tinycss2                      1.4.0
tokenizers                    0.21.0
toml                          0.10.2
tomli                         2.2.1
torch                         2.1.2+cu118
torchaudio                    2.1.2+cu118
torchvision                   0.16.2+cu118
tornado                       6.4.2
tqdm                          4.67.1
traitlets                     5.14.3
transformers                  4.49.0
transformers-stream-generator 0.0.5
triton                        2.1.0
types-python-dateutil         2.9.0.20241206
typing_extensions             4.12.2
tzdata                        2025.1
uri-template                  1.3.0
urllib3                       1.26.13
uvicorn                       0.34.0
uvloop                        0.21.0
virtualenv                    20.29.2
vllm                          0.3.2
wandb                         0.16.3
watchdog                      6.0.0
watchfiles                    1.0.4
wcwidth                       0.2.13
webcolors                     24.11.1
webencodings                  0.5.1
websocket-client              1.8.0
websockets                    15.0
wheel                         0.45.1
widgetsnbextension            4.0.13
wrapt                         1.17.2
xformers                      0.0.23.post1
xtuner                        0.1.23
xxhash                        3.5.0
yapf                          0.43.0
yarl                          1.18.3